from __future__ import annotations

from typing import Dict

from .language import DEFAULT_LANGUAGE

TRANSLATIONS: Dict[str, Dict[str, str]] = {
    "en": {
        "app_name": "MySecurity Academy",
        "welcome_title": "Welcome to MySecurity Academy",
        "welcome_message": "Learn modern cryptography through theory and practice.",
        "register": "Register",
        "login": "Log In",
        "logout": "Log Out",
        "username": "Username",
        "password": "Password",
        "password_confirm": "Confirm password",
        "encryption_algorithm": "Encryption algorithm",
        "encryption_key": "Encryption key",
        "optional_key": "Optional",
        "register_action": "Create account",
        "login_action": "Sign in",
        "dashboard_title": "Learning dashboard",
        "dashboard_description": "Choose what you want to explore today.",
        "theory": "Theory",
        "tests": "Tests",
        "admin_panel": "Admin",
        "language": "Language",
        "no_theory": "No theory materials yet.",
        "no_tests": "No tests available yet.",
        "view": "Open",
        "add_theory": "Add theory",
        "add_test": "Add test",
        "add_question": "Add question",
        "title": "Title",
        "content": "Content",
        "description": "Description",
        "language_label": "Language",
        "create": "Create",
        "select_test": "Select test",
        "question": "Question",
        "options": "Options",
        "options_hint": "Separate options with a semicolon",
        "correct_option_index": "Index of the correct option (starting from 1)",
        "submit": "Submit",
        "score_message": "You scored {score} out of {total}.",
        "admin_only": "Administrator privileges required.",
        "test_created": "Test created successfully.",
        "question_created": "Question added successfully.",
        "theory_created": "Theory material created successfully.",
        "invalid_credentials": "Invalid credentials.",
        "invalid_key": "The provided encryption key is not valid for the selected algorithm.",
        "user_exists": "User with this name already exists.",
        "password_mismatch": "Passwords do not match.",
        "choose_language": "Choose language",
        "algorithm_hint": "Algorithm hint",
        "encryption_section_title": "Pick an algorithm to protect your password",
        "theory_created_at": "Published",
        "created_at": "Created",
        "welcome_dashboard": "Welcome, {username}!",
        "register_admin_notice": "The first registered user becomes an administrator.",
        "encryption_key_optional_notice": "Some algorithms do not require a key. Check the hint before submitting.",
    },
    "ru": {
        "app_name": "Академия MySecurity",
        "welcome_title": "Добро пожаловать в Академию MySecurity",
        "welcome_message": "Изучайте современную криптографию через теорию и практику.",
        "register": "Регистрация",
        "login": "Вход",
        "logout": "Выход",
        "username": "Имя пользователя",
        "password": "Пароль",
        "password_confirm": "Подтвердите пароль",
        "encryption_algorithm": "Алгоритм шифрования",
        "encryption_key": "Ключ шифрования",
        "optional_key": "Необязательно",
        "register_action": "Создать аккаунт",
        "login_action": "Войти",
        "dashboard_title": "Учебная панель",
        "dashboard_description": "Выберите, что хотите изучить сегодня.",
        "theory": "Теория",
        "tests": "Тесты",
        "admin_panel": "Админ",
        "language": "Язык",
        "no_theory": "Теоретических материалов пока нет.",
        "no_tests": "Тестов пока нет.",
        "view": "Открыть",
        "add_theory": "Добавить теорию",
        "add_test": "Добавить тест",
        "add_question": "Добавить вопрос",
        "title": "Название",
        "content": "Содержание",
        "description": "Описание",
        "language_label": "Язык",
        "create": "Создать",
        "select_test": "Выберите тест",
        "question": "Вопрос",
        "options": "Варианты ответов",
        "options_hint": "Разделяйте варианты точкой с запятой",
        "correct_option_index": "Номер правильного варианта (начиная с 1)",
        "submit": "Отправить",
        "score_message": "Вы набрали {score} из {total}.",
        "admin_only": "Требуются права администратора.",
        "test_created": "Тест успешно создан.",
        "question_created": "Вопрос успешно добавлен.",
        "theory_created": "Теория успешно добавлена.",
        "invalid_credentials": "Неверные учетные данные.",
        "invalid_key": "Введен недопустимый ключ для выбранного алгоритма.",
        "user_exists": "Пользователь с таким именем уже существует.",
        "password_mismatch": "Пароли не совпадают.",
        "choose_language": "Выберите язык",
        "algorithm_hint": "Подсказка к алгоритму",
        "encryption_section_title": "Выберите алгоритм защиты пароля",
        "theory_created_at": "Опубликовано",
        "created_at": "Создан",
        "welcome_dashboard": "Добро пожаловать, {username}!",
        "register_admin_notice": "Первый зарегистрированный пользователь становится администратором.",
        "encryption_key_optional_notice": "Некоторым алгоритмам не нужен ключ. Смотрите подсказку перед отправкой.",
    },
}


LANGUAGE_NAMES = {
    "en": "English",
    "ru": "Русский",
}


def translate(key: str, language: str | None = None) -> str:
    lang = language or DEFAULT_LANGUAGE
    bundle = TRANSLATIONS.get(lang, TRANSLATIONS[DEFAULT_LANGUAGE])
    return bundle.get(key, TRANSLATIONS[DEFAULT_LANGUAGE].get(key, key))


def get_translation_bundle(language: str | None = None) -> Dict[str, str]:
    lang = language or DEFAULT_LANGUAGE
    return TRANSLATIONS.get(lang, TRANSLATIONS[DEFAULT_LANGUAGE])
